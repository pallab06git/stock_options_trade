# Pipeline v2 configuration — minute-level feature engineering & analysis
# Used by: MinuteDownloader, TargetedOptionsDownloader, FeatureEngineer,
#           OptionsScanner, SpaceReporter, HardwareMonitor, dashboard

pipeline_v2:
  date_range:
    start_date: "2025-03-01"
    end_date: "2025-03-31"

  feature_engineering:
    lag_windows: [1, 5, 10, 15]   # minutes
    market_open_et: "09:30"

  options:
    n_calls: 2                     # calls with strike immediately > opening
    n_puts: 2                      # puts with strike immediately <= opening
    strike_increment: 0.5          # SPY options strike price increment in dollars
    expiration_search_days: 5      # look for expiry within next 5 calendar days

  # MassiveOptionsDownloader — ticker construction approach (no list_options_contracts)
  # Use when Polygon contract discovery returns empty (free tier) or for Massive.com client
  massive_options:
    limit_per_request: 500         # bars per list_aggs call (390 bars/day max for minute)
    max_workers: 4                 # parallel download threads (one per contract)

  # ContractSelector — handshake between contract discovery and bar download
  # mode: "test" uses interactive prompting once per cycle (free tier)
  #        "prod" calls Massive list_options_contracts() and filters (paid tier)
  contract_selector:
    mode: "test"
    prod:
      underlying: "SPY"
      n_calls: 2
      n_puts: 2
      strike_increment: 0.5          # SPY $0.50 increments on paid tier
      expiry_convention: "next_trading_day"   # next_calendar_day | next_trading_day | next_friday | fixed
      expiration_search_days: 5      # retry up to 5 expiry offsets in PROD if API returns empty

  scanner:
    reference_window_minutes: 120  # rolling lookback to find reference price
    trigger_threshold_pct: 20.0    # 20%+ move triggers an event
    sustained_threshold_pct: 10.0  # 10%+ sustained move duration tracked

  reporting:
    reports_dir: "data/reports"

  hardware:
    enabled: true
    output_dir: "data/reports/hardware"

  risk_free_rate: 0.045
  dividend_yield: 0.015
